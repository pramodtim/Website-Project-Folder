<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Pramod Timalsina (Data Analyst)</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="assets/css/style.css">
<link rel="icon" href="assets/images/favicon.png">
<script defer src="assets/js/script.js"></script>
<style>
/* Chatbox styles */
#chatToggle {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: var(--primary);
  color: #fff;
  border: none;
  padding: 12px 16px;
  border-radius: 50px;
  cursor: pointer;
  z-index: 1000;
}

#chatContainer {
  position: fixed;
  bottom: 70px;
  right: 20px;
  width: 350px;
  max-height: 500px;
  background: #fff;
  border: 1px solid #ccc;
  border-radius: 12px;
  display: none;
  flex-direction: column;
  overflow: hidden;
  z-index: 999;
}

#chatBox {
  flex: 1;
  padding: 10px;
  overflow-y: auto;
  font-size: 14px;
}

#chatInputContainer {
  display: flex;
  border-top: 1px solid #ccc;
}

#chatInput {
  flex: 1;
  padding: 10px;
  border: none;
  outline: none;
}

#chatSendBtn {
  background: var(--primary);
  color: white;
  border: none;
  padding: 0 15px;
  cursor: pointer;
}
</style>
</head>
<body>

<header class="header">
  <div class="container navbar">
    <div class="logo"><a href="index.html" style="text-decoration:none;color:var(--primary)">Pramod_Timalsina</a></div>
    <nav class="navlinks" id="navLinks">
      <a href="index.html">Home</a>
      <a href="about.html">About</a>
      <a href="skills.html">Skills</a>
      <a href="projects.html">Projects</a>
      <a href="experience.html">Experience</a>
      <a href="contact.html">Contact</a>
      <a href="resume/Pramod_Timalsina_CV.pdf" class="cta" download>Download CV</a>
      <button id="themeToggle" title="Toggle theme" style="margin-left:12px;padding:8px;border-radius:8px;border:none;cursor:pointer">ðŸŒ“</button>
    </nav>
    <button id="navBtn" class="mobile-menu" style="display:none;border:none;background:none;font-size:20px;cursor:pointer">â˜°</button>
  </div>
</header>

<main class="container">
  <!-- Your existing sections -->
  <!-- Hero, Profile Summary, Projects, Footer -->
</main>

<!-- Chatbot HTML -->
<button id="chatToggle">Chat</button>
<div id="chatContainer">
  <div id="chatBox"></div>
  <div id="chatInputContainer">
    <input type="text" id="chatInput" placeholder="Type your message..." />
    <button id="chatSendBtn">Send</button>
  </div>
</div>

<script>
const chatToggle = document.getElementById("chatToggle");
const chatContainer = document.getElementById("chatContainer");
const chatBox = document.getElementById("chatBox");
const chatInput = document.getElementById("chatInput");
const chatSendBtn = document.getElementById("chatSendBtn");

chatToggle.addEventListener("click", () => {
  chatContainer.style.display = chatContainer.style.display === "flex" ? "none" : "flex";
  chatContainer.style.flexDirection = "column";
});

// Send message function
async function sendMessage() {
  const message = chatInput.value;
  if(!message) return;

  chatBox.innerHTML += `<p><b>You:</b> ${message}</p>`;
  chatInput.value = "";
  chatBox.scrollTop = chatBox.scrollHeight;

  try {
    const res = await fetch("http://127.0.0.1:8000/chat", {  // Replace with your deployed backend URL on Render/Netlify
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({message})
    });
    const data = await res.json();
    chatBox.innerHTML += `<p><b>Bot:</b> ${data.reply}</p>`;
  } catch(err) {
    chatBox.innerHTML += `<p><b>Bot:</b> Error connecting to backend.</p>`;
  }

  chatBox.scrollTop = chatBox.scrollHeight;
}

chatSendBtn.addEventListener("click", sendMessage);
chatInput.addEventListener("keypress", (e) => {
  if(e.key === "Enter") sendMessage();
});
</script>

</body>
</html>
